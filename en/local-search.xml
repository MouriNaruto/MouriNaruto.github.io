<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Using System Restore via C#</title>
    <link href="/en/2021/11/14/Using-System-Restore-via-CSharp/"/>
    <url>/en/2021/11/14/Using-System-Restore-via-CSharp/</url>
    
    <content type="html"><![CDATA[<p>This article summarizes how to use System Restore via C#.</p><p>Read <a href="https://mourinaruto.github.io/zh/2021/11/14/Using-System-Restore-with-CSharp/">here</a> for the Chinese version of this article if you are not good at English. (Translation: 如果你不擅长英文，可以点击本段话中的链接阅读中文版)</p><h2 id="Create-a-system-restore-point-via-Win32-API"><a href="#Create-a-system-restore-point-via-Win32-API" class="headerlink" title="Create a system restore point via Win32 API"></a>Create a system restore point via Win32 API</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">StructLayout(LayoutKind.Sequential)</span>]<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> RESTOREPOINTINFO<br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> dwEventType;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> dwRestorePtType;<br>    <span class="hljs-keyword">public</span> Int64 llSequenceNumber;<br>    [<span class="hljs-meta">MarshalAs(UnmanagedType.ByValTStr, SizeConst = 257)</span>]<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> szDescription;<br>&#125;<br><br>[<span class="hljs-meta">StructLayout(LayoutKind.Sequential)</span>]<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> STATEMGRSTATUS<br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">uint</span> nStatus;<br>    <span class="hljs-keyword">public</span> Int64 llSequenceNumber;<br>&#125;<br><br>[<span class="hljs-meta">DllImport(<span class="hljs-meta-string">&quot;SrClient.dll&quot;</span>)</span>]<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">SRSetRestorePoint</span>(<span class="hljs-params"><span class="hljs-keyword">ref</span> RESTOREPOINTINFO SRPInfo, <span class="hljs-keyword">ref</span> STATEMGRSTATUS SRPStatus</span>)</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span><br>&#123;<br>    RegistryKey SystemRestoreKey = Registry.LocalMachine.OpenSubKey(<span class="hljs-string">&quot;Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore&quot;</span>,<span class="hljs-literal">true</span>);<br>    SystemRestoreKey.SetValue(<span class="hljs-string">&quot;SystemRestorePointCreationFrequency&quot;</span>, <span class="hljs-number">0</span>,RegistryValueKind.DWord);<br><br>    <span class="hljs-built_in">bool</span> result = <span class="hljs-literal">false</span>;<br>    RESTOREPOINTINFO RPInfo = <span class="hljs-keyword">new</span> RESTOREPOINTINFO();<br>    STATEMGRSTATUS RPStatus = <span class="hljs-keyword">new</span> STATEMGRSTATUS();<br><br>    RPInfo.dwEventType = <span class="hljs-number">100</span>;<br>    RPInfo.dwRestorePtType = <span class="hljs-number">0</span>;<br>    RPInfo.llSequenceNumber = <span class="hljs-number">0</span>;<br>    RPInfo.szDescription = <span class="hljs-string">&quot;System Restore Point&quot;</span>;<br><br>    result = SRSetRestorePoint(<span class="hljs-keyword">ref</span> RPInfo, <span class="hljs-keyword">ref</span> RPStatus);<br><br>    SystemRestoreKey.DeleteValue(<span class="hljs-string">&quot;SystemRestorePointCreationFrequency&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Create-a-system-restore-point-via-WMI"><a href="#Create-a-system-restore-point-via-WMI" class="headerlink" title="Create a system restore point via WMI"></a>Create a system restore point via WMI</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">CreateSRP</span><span class="hljs-params">(string RPName, <span class="hljs-keyword">int</span> RPType, <span class="hljs-keyword">int</span> EventType)</span></span><br><span class="hljs-function"></span>&#123;<br>    ManagementClass SRClass = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ManagementClass</span>(<span class="hljs-string">&quot;//./root/default:SystemRestore&quot;</span>);<br><br>    ManagementBaseObject SRArgs = SRClass.<span class="hljs-built_in">GetMethodParameters</span>(<span class="hljs-string">&quot;CreateRestorePoint&quot;</span>);<br>    SRArgs[<span class="hljs-string">&quot;Description&quot;</span>] = RPName;<br>    SRArgs[<span class="hljs-string">&quot;RestorePointType&quot;</span>] = RPType;<br>    SRArgs[<span class="hljs-string">&quot;EventType&quot;</span>] = EventType;<br><br>    <span class="hljs-keyword">try</span><br>    &#123;<br>        ManagementBaseObject outParams = SRClass.<span class="hljs-built_in">InvokeMethod</span>(<span class="hljs-string">&quot;CreateRestorePoint&quot;</span>, SRArgs, <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvokeMethodOptions</span>(null, System.TimeSpan.MaxValue));<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">catch</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span><span class="hljs-params">(string[] args)</span></span><br><span class="hljs-function"></span>&#123;<br>    value = <span class="hljs-built_in">CreateSRP</span>(<span class="hljs-string">&quot;System Restore Point&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>);<br>    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">true</span>)<br>    &#123;<br>        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-string">&quot;Success&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-string">&quot;Failed&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Read</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Remove-all-system-restore-points-via-AlphaVSS-library"><a href="#Remove-all-system-restore-points-via-AlphaVSS-library" class="headerlink" title="Remove all system restore points via AlphaVSS library"></a>Remove all system restore points via AlphaVSS library</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">using</span> <span class="hljs-keyword">System</span>;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">System</span>.Collections.Generic;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">System</span>.Linq;<br><span class="hljs-keyword">using</span> Alphaleonis.Win32.Vss;<br><br>namespace SRDemoVSS<br>&#123;<br>    <span class="hljs-keyword">class</span> Program<br>    &#123;<br>        static <span class="hljs-type">void</span> Main(string[] args)<br>        &#123;<br><br>            IVssImplementation vssImplementation = VssUtils.LoadImplementation();<br>            <span class="hljs-keyword">using</span> (IVssBackupComponents backupComponents = vssImplementation.CreateVssBackupComponents())<br>            &#123;<br>                backupComponents.InitializeForBackup(<span class="hljs-keyword">null</span>);<br><br>                backupComponents.SetContext(VssSnapshotContext.<span class="hljs-keyword">All</span>);<br><br>                IList&lt;VssSnapshotProperties&gt; snapshots = backupComponents.QuerySnapshots().ToArray();<br><br>                <span class="hljs-keyword">if</span> (snapshots.Count == <span class="hljs-number">0</span>)<br>                &#123;<br>                    Console.WriteLine(&quot;There were no shadow copies on the system.&quot;);<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br><br>                try<br>                &#123;<br>                    <span class="hljs-keyword">foreach</span> (VssSnapshotProperties <span class="hljs-keyword">snapshot</span> <span class="hljs-keyword">in</span> snapshots)<br>                    &#123;<br>                        Console.WriteLine(<br>                            &quot;- Deleting shadow copy &#123;0:B&#125; on &#123;1&#125; from provider &#123;2&#125; [&#123;3&#125;]...&quot;, <br>                            <span class="hljs-keyword">snapshot</span>.SnapshotId,<br>                            <span class="hljs-keyword">snapshot</span>.OriginalVolumeName, <br>                            <span class="hljs-keyword">snapshot</span>.ProviderId, <br>                            <span class="hljs-keyword">snapshot</span>.SnapshotAttributes);<br>                        backupComponents.DeleteSnapshot(<span class="hljs-keyword">snapshot</span>.SnapshotId, <span class="hljs-keyword">false</span>);<br>                    &#125;<br>                &#125;<br>                finally &#123; &#125;<br><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Remove-all-system-restore-points-via-Win32-API-and-WMI"><a href="#Remove-all-system-restore-points-via-Win32-API-and-WMI" class="headerlink" title="Remove all system restore points via Win32 API and WMI"></a>Remove all system restore points via Win32 API and WMI</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Management;<br><span class="hljs-keyword">using</span> System.Runtime.InteropServices;<br><br><span class="hljs-keyword">namespace</span> SRDeleteDemoAPI<br>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span></span><br><span class="hljs-class">    &#123;</span><br>        [<span class="hljs-built_in">DllImport</span>(<span class="hljs-string">&quot;SrClient.dll&quot;</span>)]<br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> <span class="hljs-title">SRRemoveRestorePoint</span><span class="hljs-params">(<span class="hljs-keyword">int</span> dwRPNum)</span></span>;<br>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span><span class="hljs-params">(string[] args)</span></span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">try</span><br>            &#123;<br>                ManagementObjectSearcher SRObject = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ManagementObjectSearcher</span>(<span class="hljs-string">&quot;root/default&quot;</span>, <span class="hljs-string">&quot;SELECT * FROM SystemRestore&quot;</span>);<br>                foreach (ManagementObject SRInfo in SRObject.<span class="hljs-built_in">Get</span>())<br>                &#123;<br>                    <span class="hljs-built_in">SRRemoveRestorePoint</span>(Convert.<span class="hljs-built_in">ToInt32</span>(SRInfo[<span class="hljs-string">&quot;SequenceNumber&quot;</span>].<span class="hljs-built_in">ToString</span>()));<br>                &#125;<br>                <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">WriteLine</span>(<span class="hljs-string">&quot;Success&quot;</span>);<br>            &#125;<br>            <span class="hljs-built_in"><span class="hljs-keyword">catch</span></span> (Exception)<br>            &#123;<br>                <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">WriteLine</span>(<span class="hljs-string">&quot;Failure&quot;</span>);<br>            &#125;            <br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Restore-from-a-system-restore-point-via-WMI"><a href="#Restore-from-a-system-restore-point-via-WMI" class="headerlink" title="Restore from a system restore point via WMI"></a>Restore from a system restore point via WMI</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Management;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">RestoreFromRestorePoint</span><span class="hljs-params">(<span class="hljs-keyword">int</span> RPNum)</span></span><br><span class="hljs-function"></span>&#123;<br>    ManagementClass SRClass = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ManagementClass</span>(<span class="hljs-string">&quot;//./root/default:SystemRestore&quot;</span>);<br><br>    <span class="hljs-keyword">try</span><br>    &#123;<br>        object[] SRArgs = &#123; RPNum &#125;;<br>        SRClass.<span class="hljs-built_in">InvokeMethod</span>(<span class="hljs-string">&quot;Restore&quot;</span>, SRArgs);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">catch</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;   <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Enable-System-Restore-for-the-specific-drive-C-drive-for-example-via-Win32-API"><a href="#Enable-System-Restore-for-the-specific-drive-C-drive-for-example-via-Win32-API" class="headerlink" title="Enable System Restore for the specific drive (C drive for example) via Win32 API"></a>Enable System Restore for the specific drive (C drive for example) via Win32 API</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Runtime.InteropServices;<br><br><span class="hljs-keyword">namespace</span> SRTest<br>&#123;<br>        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span></span><br><span class="hljs-class">        &#123;</span><br>                [<span class="hljs-built_in">DllImport</span>(<span class="hljs-string">&quot;SrClient.dll&quot;</span>)]<br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> <span class="hljs-title">EnableSR</span><span class="hljs-params">([MarshalAs(UnmanagedType.LPWStr)]string Drive)</span></span>;<br>        <br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span><span class="hljs-params">(string[] args)</span></span><br><span class="hljs-function">                </span>&#123;                        <br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-built_in">EnableSR</span>(<span class="hljs-string">&quot;C:\\&quot;</span>));<br>                                                <br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-string">&quot;Press any key to continue . . . &quot;</span>);<br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">ReadKey</span>(<span class="hljs-literal">true</span>);<br>                &#125;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Disable-System-Restore-for-the-specific-drive-C-drive-for-example-via-Win32-API"><a href="#Disable-System-Restore-for-the-specific-drive-C-drive-for-example-via-Win32-API" class="headerlink" title="Disable System Restore for the specific drive (C drive for example) via Win32 API"></a>Disable System Restore for the specific drive (C drive for example) via Win32 API</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">using</span> System;<br><span class="hljs-keyword">using</span> System.Runtime.InteropServices;<br><br><span class="hljs-keyword">namespace</span> SRTest<br>&#123;<br>        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Program</span></span><br><span class="hljs-class">        &#123;</span><br>                [<span class="hljs-built_in">DllImport</span>(<span class="hljs-string">&quot;SrClient.dll&quot;</span>)]<br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> <span class="hljs-title">DisableSR</span><span class="hljs-params">([MarshalAs(UnmanagedType.LPWStr)]string Drive)</span></span>;      <br>        <br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span><span class="hljs-params">(string[] args)</span></span><br><span class="hljs-function">                </span>&#123;                        <br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-built_in">DisableSR</span>(<span class="hljs-string">&quot;C:\\&quot;</span>));<br>                                                <br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">Write</span>(<span class="hljs-string">&quot;Press any key to continue . . . &quot;</span>);<br>                        <span class="hljs-built_in">Console</span>.<span class="hljs-built_in">ReadKey</span>(<span class="hljs-literal">true</span>);<br>                &#125;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://bbs.pcbeta.com/viewthread-1507617-1-1.html">Windows系统还原新探（Windows系统还原的较深入研究）</a></li></ul><h2 id="See-also"><a href="#See-also" class="headerlink" title="See also"></a>See also</h2><ul><li><a href="#">Post not found: The-usage-of-System-Restore</a></li><li><a href="/en/2021/11/02/Windows-Research-Notes/" title="Windows Research Notes">Windows Research Notes</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Technologies</category>
      
      <category>Windows</category>
      
      <category>Windows Research Notes</category>
      
      <category>System Restore</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>Technologies</tag>
      
      <tag>Windows Research Notes</tag>
      
      <tag>System Restore</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows Research Notes</title>
    <link href="/en/2021/11/02/Windows-Research-Notes/"/>
    <url>/en/2021/11/02/Windows-Research-Notes/</url>
    
    <content type="html"><![CDATA[<h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>Hi there, I go by Kenji Mouri.</p><p>I like to write technical articles, especially I like to post long technical posts in PCBeta Forum. Because I think posting in a forum where a lot of people go can make more people see it and make more people get help because of thetechnical articles I write.</p><p>Around 2014 to 2016 was my productive period. Then I did not publish many technical articles because I was not inspiredto write long-form technical articles. But I did not have the courage to publish short technical articles in that time, because I was afraid that others said I was publishing useless posts in the forum.</p><p>As we all know, the server of PCBeta Forum was very unstable and inaccessible in the past few years. So at that time, Ihad the idea of summarizing all the articles I had published in forums like PCBeta into a blog I hosted on GitHub. After all, forums can’t exist forever, but Git repositories everyone can make backups of, and make it able to keep thecontent I write.</p><p>Later, after the PCBeta Forum was back to normal, I forgot about it. Until recently, when I was encouraged to do so bymy friend walterlv, because of some opportunity.</p><p>I will not simply archive the technical articles I wrote before, but will errata and rewrite the content according tothe previous content with my current perspective. I hope this will reduce potential misunderstandings and better help readers who read this series of articles.</p><p>If you find any errors in this series of articles, or have better suggestions, please send your feedback directly to<a href="https://github.com/MouriNaruto/MouriNaruto/issues">https://github.com/MouriNaruto/MouriNaruto/issues</a>.</p><p>Note: This index will be updated as the content of this series is updated.</p><p>Note: Article entries without hyperlinks in the table of contents are what I want to write about in the future.</p><p>Read <a href="https://mourinaruto.github.io/zh/2021/11/02/Windows-Research-Notes/">here</a> for the Chinese version of this article if you are not good at English. (Translation: 如果你不擅长英文，可以点击本段话中的链接阅读中文版)</p><h2 id="Table-of-contents"><a href="#Table-of-contents" class="headerlink" title="Table of contents"></a>Table of contents</h2><ul><li>System Restore<ul><li><a href="#">Post not found: The-usage-of-System-Restore</a></li><li><a href="/en/2021/11/14/Using-System-Restore-via-CSharp/" title="Using System Restore via C#">Using System Restore via C#</a></li><li><a href="#">Post not found: Using-System-Restore-with-Cpp</a></li><li><a href="#">Post not found: New-behavior-of-System-Restore-since-Windows-8</a></li></ul></li><li>Compact OS<ul><li><a href="#">Post not found: The-history-and-principle-of-Compact-OS</a></li><li><a href="#">Post not found: The-exclusion-list-of-Compact-OS</a></li><li><a href="#">Post not found: The-usage-of-Compact-OS</a></li></ul></li><li>Windows User Mode (Win32 API, NT API, Windows Runtime)<ul><li><a href="#">Post not found: Enable-Per-Monitor-DPI-Awareness-Mode-for-File-Explorer-in-Windows-10</a></li><li><a href="#">Post not found: Modify-the-size-of-Start-Screen-in-Windows-8-1</a></li><li><a href="#">Post not found: Notes-for-implement-Per-Monitor-DPI-Awareness-Mode-support-in-earlier-versions-of-Windows-10</a></li><li><a href="#">Post not found: Launch-Windows-Store-App-via-Win32-API</a></li><li><a href="#">Post not found: Defrag-memory-with-NT-API</a></li><li><a href="#">Post not found: Bypass-file-and-registry-access-check-only-with-Administrator</a></li></ul></li><li>Development Environment (Visual Studio, MSBuild, Cargo)<ul><li><a href="#">Post not found: Control-the-memory-usage-of-WSL-2-instance</a></li><li><a href="#">Post not found: Use-VC-LTL-in-your-Rust-projects</a></li><li><a href="#">Post not found: Develop-autonomous-driving-stack-with-Autoware-Auto-and-Windows-11</a></li><li><a href="#">Post not found: Tricks-for-parallel-compilation-with-MSVC-toolchain</a></li><li><a href="#">Post not found: Some-noticeable-issues-in-Windows-10-Build-1904x-ISOs</a></li><li><a href="#">Post not found: Build-Qt-6-with-VC-LTL</a></li><li><a href="#">Post not found: Use-VC-LTL-in-your-Cpp-WinRT-UWP-projects</a></li></ul></li></ul><h2 id="Pending-articles"><a href="#Pending-articles" class="headerlink" title="Pending articles"></a>Pending articles</h2><ul><li><a href="http://bbs.pcbeta.com/viewthread-1611980-1-1.html">浅谈Metro App的沙盒AppContainer</a>  </li><li><a href="http://bbs.pcbeta.com/viewthread-1519551-1-1.html">原生集成Windows 8/8.1 自带的Windows Defender病毒库的教程</a></li></ul><h2 id="Planned-articles"><a href="#Planned-articles" class="headerlink" title="Planned articles"></a>Planned articles</h2><ul><li>App Container<ul><li>App Container 基本介绍</li><li>通过 Win32 API 使用 App Container</li><li>通过第三方工具使用 App Container</li><li>通过 NT API 创建 App Container 访问令牌及注意事项</li><li>Windows 10 及之后版本的 App Container 行为变更</li></ul></li><li>Windows 用户模式 (Win32 API, NT API, Windows Runtime)<ul><li>Windows 内置的 C 运行时库的历史沿革</li><li>通过 Windows Runtime API 实现对商店应用的升级</li><li>Windows 应用程序打包项目的已知问题和解决方案</li><li>使用 C++/WinRT 实现一个轻量级 XAML Island 应用</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>Technologies</category>
      
      <category>Windows</category>
      
      <category>Windows Research Notes</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>Technologies</tag>
      
      <tag>Windows Research Notes</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Drop ARM32 support on the Windows platform</title>
    <link href="/en/2021/05/17/Drop-ARM32-support-on-the-Windows-platform/"/>
    <url>/en/2021/05/17/Drop-ARM32-support-on-the-Windows-platform/</url>
    
    <content type="html"><![CDATA[<p>For my deliberate consideration, The open source projects created or maintainedby myself will drop the ARM32 support on the Windows platform. Here are thereasons:</p><ul><li>The latest version of ARM32 version for Windows desktop is Redstone 2 InsiderBuild 15035. I know Windows RT 8.1 and Windows 10 IoT Core aren’t in the stage of end of support, but most of daily users are drop their devices (Windows RT 8.x tablets) or have a better solution (Windows 10 IoT Core userson Raspberry Pi devices should migrate to Linux or ARM64 version for Windows10 desktop).</li><li>Future ARM processors are deprecating ARM32 ISA support, and Apple Silicon M1had dropped the ARM32 support at all. So we can’t run ARM32 version of Windows desktop applications on these devices.</li><li>I’m considering the possibility of using Rust, .NET, and Project Reunion towrite a part of the implementation of some projects in the future, and theseinfrastructures will not reconsider support for ARM32 support on Windows.</li><li>Reduce the size of release package and make the continuous integrationfaster.</li></ul><p>Kenji Mouri</p>]]></content>
    
    
    <categories>
      
      <category>Notice</category>
      
      <category>Windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Notice</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>From Beijing to Cyberpunk 2077</title>
    <link href="/en/2020/12/18/from-beijing-to-cyberpunk-2077/"/>
    <url>/en/2020/12/18/from-beijing-to-cyberpunk-2077/</url>
    
    <content type="html"><![CDATA[<p>This article is Chinese version only, read <a href="https://mourinaruto.github.io/zh/2020/12/18/from-beijing-to-cyberpunk-2077/">here</a>for the Chinese version and go back to the English blog via clicking the <code>English</code> button in the navigation bar.</p>]]></content>
    
    
    <categories>
      
      <category>Games</category>
      
      <category>Cyberpunk 2077</category>
      
      <category>Life</category>
      
      <category>Beijing</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games</tag>
      
      <tag>Cyberpunk 2077</tag>
      
      <tag>Life</tag>
      
      <tag>Beijing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Using CI in my blog repo</title>
    <link href="/en/2020/12/06/using-ci-in-my-blog-repo/"/>
    <url>/en/2020/12/06/using-ci-in-my-blog-repo/</url>
    
    <content type="html"><![CDATA[<p>This article is Chinese version only, read <a href="https://mourinaruto.github.io/zh/2020/12/06/using-ci-in-my-blog-repo/">here</a>for the Chinese version and go back to the English blog via clicking the <code>English</code> button in the navigation bar.</p>]]></content>
    
    
    <categories>
      
      <category>Technologies</category>
      
      <category>Deployments</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Technologies</tag>
      
      <tag>CI</tag>
      
      <tag>AppVeyor</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Share my design in shapez.io</title>
    <link href="/en/2020/11/02/share-my-design-in-shapez-io/"/>
    <url>/en/2020/11/02/share-my-design-in-shapez-io/</url>
    
    <content type="html"><![CDATA[<p>This article is Chinese version only, read <a href="https://mourinaruto.github.io/zh/2020/11/02/share-my-design-in-shapez-io/">here</a>for the Chinese version and go back to the English blog via clicking the <code>English</code> button in the navigation bar.</p>]]></content>
    
    
    <categories>
      
      <category>Games</category>
      
      <category>shapez.io</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games</tag>
      
      <tag>shapez.io</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
