<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/en/../img/favicon.png"><link rel="icon" href="/en/../img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Kenji Mouri"><meta name="keywords" content=""><meta name="description" content="When I was developing NanaZip, I found if my Windows Application Packaging project with multiple referenced projects, it will output to the separate folder with the names of the referenced projects."><meta property="og:type" content="article"><meta property="og:title" content="Set Windows Application Packaging project with multiple referenced projects to a common output folder"><meta property="og:url" content="https://mourinaruto.github.io/en/2021/12/26/Set-Windows-Application-Packaging-project-with-multiple-referenced-projects-to-a-common-output-folder/index.html"><meta property="og:site_name" content="Kenji Mouri"><meta property="og:description" content="When I was developing NanaZip, I found if my Windows Application Packaging project with multiple referenced projects, it will output to the separate folder with the names of the referenced projects."><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2021-12-26T23:24:59.000Z"><meta property="article:modified_time" content="2024-12-10T00:41:04.859Z"><meta property="article:author" content="Kenji Mouri"><meta property="article:tag" content="Technologies"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Windows Apps"><meta property="article:tag" content="Development"><meta property="article:tag" content="Experience"><meta name="twitter:card" content="summary_large_image"><title>Set Windows Application Packaging project with multiple referenced projects to a common output folder - Kenji Mouri</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/en/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.6.0/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/en/css/main.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_2188012_jkjop06z1g.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"mourinaruto.github.io",root:"/en/",version:"1.8.14",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:1280544492,leancloud:{app_id:"qEO7L1QVXqw752KnQk88IfDS-MdYXbMMI",app_key:"fEqb7CwIp1LJnuHKnhRlI2wh",server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/en/local-search.xml"}</script><script src="/en/js/utils.js"></script><script src="/en/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/en/"><strong>Kenji Mouri</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/en/"><i class="iconfont icon-home-fill"></i> Home</a></li><li class="nav-item"><a class="nav-link" href="/en/archives/"><i class="iconfont icon-archive-fill"></i> Archives</a></li><li class="nav-item"><a class="nav-link" href="/en/categories/"><i class="iconfont icon-category-fill"></i> Categories</a></li><li class="nav-item"><a class="nav-link" href="/en/tags/"><i class="iconfont icon-tags-fill"></i> Tags</a></li><li class="nav-item"><a class="nav-link" target="_blank" rel="noopener" href="https://github.com/MouriNaruto/MouriDocs"><i class="iconfont icon-book"></i> Docs</a></li><li class="nav-item"><a class="nav-link" href="https://mourinaruto.github.io/zh/"><i class="iconfont icon-book"></i> 中文</a></li><li class="nav-item"><a class="nav-link" href="/en/about/"><i class="iconfont icon-user-fill"></i> About</a></li><li class="nav-item"><a class="nav-link" href="/en/links/"><i class="iconfont icon-link-fill"></i> Links</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/en/../img/background.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Set Windows Application Packaging project with multiple referenced projects to a common output folder"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-12-26 23:24" pubdate>December 26, 2021 pm</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.4k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 21 minutes</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Set Windows Application Packaging project with multiple referenced projects to a common output folder</h1><div class="markdown-body"><p>When I was developing <a target="_blank" rel="noopener" href="https://github.com/M2Team/NanaZip">NanaZip</a>, I found if my Windows Application Packaging project with multiple referenced projects, it will output to the separate folder with the names of the referenced projects.</p><p>It’s really annoying me, and I had try to find a solution.</p><p>First, I found <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/62853610">the same issue I have in Stack Overflow</a>, and I tried to use the way in the answer for solving the issue, but it doesn’t work if we want to reference some Windows Runtime components.</p><p>But I know the Windows Terminal is the project with multiple referenced projects and it will output to a common folder. So, I had taken a good look at the source code of Windows Terminal and found the way to solve the issue.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Add the following to the end of the <code>Project</code> node to resolve the issue.</p><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- ## BEGIN HACK - Put all output files to the AppX root folder ## --&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  Reference: https://github.com/microsoft/terminal</span><br><span class="hljs-comment">             /blob/a89c3e2f8527a51b39768980627ed8f7c1ea5f0b</span><br><span class="hljs-comment">             /src/cascadia/CascadiaPackage/CascadiaPackage.wapproj#L73</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-comment">&lt;!-- </span><br><span class="hljs-comment">  For our builds, we want to put all output files to the AppX root folder for</span><br><span class="hljs-comment">  simplifying the implementation.</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Target</span> <span class="hljs-attr">Name</span>=<span class="hljs-string">&quot;MileProjectStompSourceProjectForWapProject&quot;</span> <span class="hljs-attr">BeforeTargets</span>=<span class="hljs-string">&quot;_ConvertItems&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      Stomp all &quot;SourceProject&quot; values for all incoming dependencies to </span><br><span class="hljs-comment">      flatten the package. </span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">_TemporaryFilteredWapProjOutput</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;@(_FilteredNonWapProjProjectOutput)&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">_FilteredNonWapProjProjectOutput</span> <span class="hljs-attr">Remove</span>=<span class="hljs-string">&quot;@(_TemporaryFilteredWapProjOutput)&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">_FilteredNonWapProjProjectOutput</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;@(_TemporaryFilteredWapProjOutput)&quot;</span>&gt;</span><br>      <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      Blank the SourceProject here to vend all files into the root of the</span><br><span class="hljs-comment">      package.</span><br><span class="hljs-comment">    --&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">SourceProject</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">SourceProject</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">_FilteredNonWapProjProjectOutput</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Target</span>&gt;</span><br><span class="hljs-comment">&lt;!-- ## END HACK - Put all output files to the AppX root folder ## --&gt;</span><br></code></pre></td></tr></table></figure><h2 id="Afterword"><a href="#Afterword" class="headerlink" title="Afterword"></a>Afterword</h2><p>It’s a really disgusting issue for developers. But the Microsoft won’t fix that. The discussion can be found <a target="_blank" rel="noopener" href="https://developercommunity.visualstudio.com/t/1110232">here</a>.</p><blockquote><p>As you can imagine there is a reason that we do this and the primary concern is duplicate filenames as well as some issues with uploading to the store. As of now there is no override that we provide that will allow you to achieve this although there are some hacks you could do to make it possible but it is not advised.​ (By Scoban [MSFT])</p></blockquote><p>The development team of Windows Terminal has made some hacking to MSBuild Windows Application Packaging project targets for achieving the goal. I am proud I can find it and solve the issue when I am developing NanaZip.</p><p>I hope the article can give some help for Windows desktop app developers. Thanks for reading.</p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/en/categories/Technologies/">Technologies</a> <a class="hover-with-bg" href="/en/categories/Technologies/Windows/">Windows</a> <a class="hover-with-bg" href="/en/categories/Technologies/Windows/Windows-Apps/">Windows Apps</a> <a class="hover-with-bg" href="/en/categories/Technologies/Windows/Windows-Apps/Development/">Development</a> <a class="hover-with-bg" href="/en/categories/Technologies/Windows/Windows-Apps/Development/Experience/">Experience</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/en/tags/Technologies/">Technologies</a> <a class="hover-with-bg" href="/en/tags/Windows/">Windows</a> <a class="hover-with-bg" href="/en/tags/Windows-Apps/">Windows Apps</a> <a class="hover-with-bg" href="/en/tags/Development/">Development</a> <a class="hover-with-bg" href="/en/tags/Experience/">Experience</a></div></div><p class="note note-warning">Unless otherwise stated, all articles in this blog follow the <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" rel="nofollow noopener noopener">CC BY-NC-ND 4.0 license</a>, please indicate the source for reprinting!</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/en/2021/12/27/The-way-to-submit-a-headless-app-to-the-Microsoft-Store/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">The way to submit a headless app to the Microsoft Store</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/en/2021/12/25/Share-my-experience-of-implementing-context-menu-support-for-File-Explorer-in-Windows-11/"><span class="hidden-mobile">Share my experience of implementing context menu support for File Explorer in Windows 11</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){var t=document.documentElement.getAttribute("data-user-color-scheme");t="dark"===t?"github-dark":"github-light",window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark";var e=document.createElement("script");e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","MouriNaruto/MouriNaruto"),e.setAttribute("issue-term","pathname"),e.setAttribute("label","blog"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">Total number of visits: <span id="leancloud-site-pv"></span> </span><span id="leancloud-site-uv-container" style="display:none">Total number of visitors: <span id="leancloud-site-uv"></span></span></div><span id="cnzz_stat_icon_1280544492" style="display:none"></span></footer><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"></script><script src="/en/js/events.js"></script><script src="/en/js/plugins.js"></script><script src="/en/js/local-search.js"></script><script src="/en/js/img-lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/tocbot@4.12.2/dist/tocbot.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script><script defer src="/en/js/leancloud.js"></script><script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script defer src="//s4.cnzz.com/z_stat.php?id=1280544492&show=pic" type="text/javascript"></script><script src="/en/js/boot.js"></script></body></html>